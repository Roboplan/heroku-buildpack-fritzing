#!/usr/bin/env bash
set -e
BUILD_DIR=$1
CACHE_DIR=$2

# Set fritzing download path
FRITZING_FILE=fritzing-0.9.2b.linux.AMD64.tar.bz2
FRITZING_SOURCE=http://fritzing.org/download/0.9.2b/linux-64bit
FRITZING_TARGET_PATH=$BUILD_DIR/.fritzing
#FRITZING_TARGET_PATH=$BUILD_DIR/vendor/fritzing

#
# Install fritzing
#
echo "-----> Downloading fritzing"

mkdir -p $BUILD_DIR/.fritzing
wget $FRITZING_SOURCE/$FRITZING_FILE -P $BUILD_DIR/.fritzing -N

echo "-----> Done"
echo "-----> Extracting fritzing"

tar xjvf $BUILD_DIR/.fritzing/$FRITZING_FILE -C $BUILD_DIR/.fritzing --strip-components 1

echo "-----> Done"
echo "-----> Creating a simlink"

#ln -s ../fritzing/Fritzing $BUILD_DIR/vendor/bin/Fritzing

echo "-----> Done"
echo "-----> Creating init scripts"

mkdir -p $BUILD_DIR/.profile.d
cat <<EOF >$BUILD_DIR/.profile.d/fritzing_defaults.sh
export PATH="\$HOME/.fritzing:\$PATH"
EOF

echo "-----> Done"

echo "-----> Compilation Finished"
exit 0
